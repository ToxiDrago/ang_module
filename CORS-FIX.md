# üîß CORS Fix Documentation

## üö® –ü—Ä–æ–±–ª–µ–º–∞

Frontend –Ω–∞ `http://localhost:59177` –Ω–µ –º–æ–∂–µ—Ç –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ backend –Ω–∞ `http://localhost:3000` –∏–∑-–∑–∞ CORS –ø–æ–ª–∏—Ç–∏–∫–∏.

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### 1. –û–±–Ω–æ–≤–ª–µ–Ω–∞ CORS –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ `src/backend.main.ts`:

```typescript
app.enableCors({
  origin: [
    "http://localhost:4200",
    "http://localhost:59177",
    /^http:\/\/localhost:\d+$/, // –†–∞–∑—Ä–µ—à–∞–µ–º –≤—Å–µ localhost –ø–æ—Ä—Ç—ã
  ],
  methods: "GET,HEAD,PUT,PATCH,POST,DELETE,OPTIONS",
  allowedHeaders: "Content-Type, Accept, Authorization",
  credentials: true,
});
```

### 2. –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å:

- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω `http://localhost:59177` –≤ —Å–ø–∏—Å–æ–∫ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã—Ö origins
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω regex `/^http:\/\/localhost:\d+$/` –¥–ª—è –≤—Å–µ—Ö localhost –ø–æ—Ä—Ç–æ–≤
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `OPTIONS` –¥–ª—è preflight –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –∑–∞–≥–æ–ª–æ–≤–æ–∫ `Authorization` –¥–ª—è JWT —Ç–æ–∫–µ–Ω–æ–≤

### 3. –ö–∞–∫ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è:

```bash
# 1. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å backend (–µ—Å–ª–∏ –∑–∞–ø—É—â–µ–Ω)
taskkill //F //IM node.exe

# 2. –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å backend
npm run build:backend

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å backend
npm run start:backend

# 4. –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É frontend –≤ –±—Ä–∞—É–∑–µ—Ä–µ
```

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π:

1. –û—Ç–∫—Ä–æ–π—Ç–µ DevTools –≤ –±—Ä–∞—É–∑–µ—Ä–µ (F12)
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É Network
3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –≤—ã–∑—ã–≤–∞–µ—Ç API –∑–∞–ø—Ä–æ—Å
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∑–∞–ø—Ä–æ—Å—ã –ø—Ä–æ—Ö–æ–¥—è—Ç –±–µ–∑ CORS –æ—à–∏–±–æ–∫

### 5. –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è:

–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –æ—Å—Ç–∞–µ—Ç—Å—è, –º–æ–∂–Ω–æ –≤—Ä–µ–º–µ–Ω–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:

```typescript
// –í src/backend.main.ts - —Ä–∞–∑—Ä–µ—à–∏—Ç—å –≤—Å–µ origins (—Ç–æ–ª—å–∫–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏!)
app.enableCors({
  origin: true, // –†–∞–∑—Ä–µ—à–∏—Ç—å –≤—Å–µ origins
  methods: "GET,HEAD,PUT,PATCH,POST,DELETE,OPTIONS",
  allowedHeaders: "Content-Type, Accept, Authorization",
  credentials: true,
});
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–°–æ–∑–¥–∞–Ω —Ç–µ—Å—Ç `test-cors-fix.js` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ CORS –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:

```bash
node test-cors-fix.js
```

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫ backend
- Frontend –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π
- –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è CORS –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å backend
- –í production –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –¥–æ–º–µ–Ω—ã –≤–º–µ—Å—Ç–æ wildcard

## üîç –û—Ç–ª–∞–¥–∫–∞

–ï—Å–ª–∏ CORS –æ—à–∏–±–∫–∏ –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç—Å—è:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ backend –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω
2. –û—á–∏—Å—Ç–∏—Ç–µ –∫—ç—à –±—Ä–∞—É–∑–µ—Ä–∞
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –æ—Ç–≤–µ—Ç–∞ –≤ DevTools
4. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ frontend –¥–µ–ª–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º—É URL
